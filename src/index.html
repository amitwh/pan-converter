<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PanConverter - Markdown Editor</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
</head>
<body>
    <div class="container">
        <div class="tab-bar" id="tab-bar">
            <div class="tab active" data-tab-id="1">
                <span class="tab-title">Untitled</span>
                <button class="tab-close" title="Close tab">×</button>
            </div>
            <button class="new-tab-button" id="new-tab-btn" title="New tab">+</button>
        </div>
        <div class="toolbar">
            <button id="btn-bold" title="Bold">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>
                    <path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>
                </svg>
            </button>
            <button id="btn-italic" title="Italic">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="19" y1="4" x2="10" y2="4"></line>
                    <line x1="14" y1="20" x2="5" y2="20"></line>
                    <line x1="15" y1="4" x2="9" y2="20"></line>
                </svg>
            </button>
            <button id="btn-heading" title="Heading">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="4 7 4 4 20 4 20 7"></polyline>
                    <line x1="9" y1="20" x2="15" y2="20"></line>
                    <line x1="12" y1="4" x2="12" y2="20"></line>
                </svg>
            </button>
            <button id="btn-link" title="Link">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                </svg>
            </button>
            <button id="btn-code" title="Code">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="16 18 22 12 16 6"></polyline>
                    <polyline points="8 6 2 12 8 18"></polyline>
                </svg>
            </button>
            <button id="btn-list" title="List">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="8" y1="6" x2="21" y2="6"></line>
                    <line x1="8" y1="12" x2="21" y2="12"></line>
                    <line x1="8" y1="18" x2="21" y2="18"></line>
                    <line x1="3" y1="6" x2="3.01" y2="6"></line>
                    <line x1="3" y1="12" x2="3.01" y2="12"></line>
                    <line x1="3" y1="18" x2="3.01" y2="18"></line>
                </svg>
            </button>
            <button id="btn-quote" title="Quote">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"></path>
                    <path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"></path>
                </svg>
            </button>
            <button id="btn-table" title="Insert Table">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="3" y1="9" x2="21" y2="9"></line>
                    <line x1="3" y1="15" x2="21" y2="15"></line>
                    <line x1="9" y1="3" x2="9" y2="21"></line>
                    <line x1="15" y1="3" x2="15" y2="21"></line>
                </svg>
            </button>
            <div class="toolbar-separator"></div>
            <button id="btn-find" title="Find & Replace (Ctrl+F)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
            </button>
            <button id="btn-line-numbers" title="Toggle Line Numbers">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 6h18"></path>
                    <path d="M3 12h18"></path>
                    <path d="M3 18h18"></path>
                </svg>
            </button>
            <div class="toolbar-separator"></div>
            <button id="btn-preview-toggle" title="Toggle Preview">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                </svg>
            </button>
        </div>
        
        <!-- Find & Replace Dialog -->
        <div id="find-dialog" class="find-dialog hidden">
            <div class="find-controls">
                <input type="text" id="find-input" placeholder="Find...">
                <input type="text" id="replace-input" placeholder="Replace...">
                <button id="btn-find-prev" title="Previous">↑</button>
                <button id="btn-find-next" title="Next">↓</button>
                <button id="btn-replace" title="Replace">Replace</button>
                <button id="btn-replace-all" title="Replace All">All</button>
                <button id="btn-find-close" title="Close">×</button>
            </div>
            <div class="find-info">
                <span id="find-count">0 matches</span>
            </div>
        </div>

        <!-- Export Options Dialog -->
        <div id="export-dialog" class="export-dialog hidden">
            <div class="export-dialog-content">
                <div class="export-dialog-header">
                    <h3 id="export-dialog-title">Export Options</h3>
                    <button id="export-dialog-close" title="Close">×</button>
                </div>
                <div class="export-dialog-body">
                    <!-- Simple/Advanced Export Toggle -->
                    <div class="export-section export-mode-toggle">
                        <label class="checkbox-label">
                            <input type="checkbox" id="advanced-export-toggle">
                            <span class="checkmark"></span>
                            Show Advanced Options
                        </label>
                        <small class="export-help">Enable for templates, metadata, bibliography, and advanced PDF settings</small>
                    </div>

                    <!-- Advanced Export Options (hidden by default) -->
                    <div id="advanced-export-options" class="advanced-options hidden">
                        <div class="export-section">
                            <label for="export-template">Template:</label>
                        <select id="export-template">
                            <option value="default">Default</option>
                            <option value="custom">Custom (Browse...)</option>
                        </select>
                        <input type="file" id="template-file-input" accept=".tex,.html,.docx,.odt" style="display: none;">
                        <input type="text" id="custom-template-path" placeholder="Template file path..." style="display: none;">
                    </div>

                    <div class="export-section">
                        <label>Metadata:</label>
                        <div class="metadata-container">
                            <div class="metadata-field">
                                <input type="text" placeholder="title" class="metadata-key">
                                <input type="text" placeholder="Document title" class="metadata-value">
                            </div>
                            <div class="metadata-field">
                                <input type="text" placeholder="author" class="metadata-key">
                                <input type="text" placeholder="Author name" class="metadata-value">
                            </div>
                            <div class="metadata-field">
                                <input type="text" placeholder="date" class="metadata-key">
                                <input type="text" placeholder="Date" class="metadata-value">
                            </div>
                            <div class="metadata-field">
                                <input type="text" placeholder="subject" class="metadata-key">
                                <input type="text" placeholder="Subject" class="metadata-value">
                            </div>
                        </div>
                        <button id="add-metadata-field" type="button">+ Add Field</button>
                    </div>

                    <div class="export-section">
                        <label>Document Options:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="export-toc"> Table of Contents</label>
                            <label><input type="checkbox" id="export-number-sections"> Number Sections</label>
                            <label><input type="checkbox" id="export-citeproc"> Process Citations</label>
                        </div>
                        <div class="form-row">
                            <label for="export-toc-depth">TOC Depth:</label>
                            <input type="number" id="export-toc-depth" min="1" max="6" value="3">
                        </div>
                    </div>

                    <div class="export-section pdf-only">
                        <label>PDF Options:</label>
                        <div class="form-row">
                            <label for="pdf-engine">PDF Engine:</label>
                            <select id="pdf-engine">
                                <option value="xelatex">XeLaTeX (Recommended)</option>
                                <option value="pdflatex">PDFLaTeX</option>
                                <option value="lualatex">LuaLaTeX</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <label for="pdf-geometry">Page Margins:</label>
                            <select id="pdf-geometry">
                                <option value="margin=1in">1 inch (Default)</option>
                                <option value="margin=0.75in">0.75 inch</option>
                                <option value="margin=1.25in">1.25 inch</option>
                                <option value="margin=2cm">2 cm</option>
                                <option value="margin=2.5cm">2.5 cm</option>
                                <option value="custom">Custom...</option>
                            </select>
                            <input type="text" id="custom-geometry" placeholder="e.g., margin=1.5in" style="display: none;">
                        </div>
                    </div>

                    <div class="export-section">
                        <label>Bibliography:</label>
                        <div class="form-row">
                            <input type="text" id="bibliography-file" placeholder="Bibliography file (.bib, .yaml, .json)">
                            <button id="browse-bibliography">Browse</button>
                        </div>
                        <div class="form-row">
                            <input type="text" id="csl-file" placeholder="Citation style file (.csl)">
                            <button id="browse-csl">Browse</button>
                        </div>
                    </div>
                    </div> <!-- End advanced-export-options -->

                    <!-- Basic Export Options (always visible) -->
                    <div class="export-section basic-options">
                        <label>Quick Export Settings:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="basic-toc"> Include Table of Contents</label>
                            <label><input type="checkbox" id="basic-number-sections"> Number Sections</label>
                        </div>
                    </div>
                </div>
                <div class="export-dialog-footer">
                    <button id="export-cancel">Cancel</button>
                    <button id="export-confirm" class="primary">Export</button>
                </div>
            </div>
        </div>

        <!-- Batch Conversion Dialog -->
        <div id="batch-dialog" class="batch-dialog hidden">
            <div class="batch-dialog-content">
                <div class="batch-dialog-header">
                    <h3>Batch File Conversion</h3>
                    <button id="batch-dialog-close" title="Close">×</button>
                </div>
                <div class="batch-dialog-body">
                    <div class="batch-section">
                        <label>Input Folder:</label>
                        <div class="folder-input-group">
                            <input type="text" id="batch-input-folder" placeholder="Select folder containing markdown files..." readonly>
                            <button id="browse-input-folder">Browse</button>
                        </div>
                    </div>

                    <div class="batch-section">
                        <label>Output Folder:</label>
                        <div class="folder-input-group">
                            <input type="text" id="batch-output-folder" placeholder="Select output folder..." readonly>
                            <button id="browse-output-folder">Browse</button>
                        </div>
                    </div>

                    <div class="batch-section">
                        <label for="batch-format">Output Format:</label>
                        <select id="batch-format">
                            <option value="html">HTML</option>
                            <option value="pdf">PDF</option>
                            <option value="docx">DOCX</option>
                            <option value="latex">LaTeX</option>
                            <option value="rtf">RTF</option>
                            <option value="odt">ODT</option>
                            <option value="epub">EPUB</option>
                            <option value="pptx">PowerPoint (PPTX)</option>
                            <option value="odp">OpenDocument Presentation (ODP)</option>
                        </select>
                    </div>

                    <div class="batch-section">
                        <label>
                            <input type="checkbox" id="batch-include-subfolders" checked>
                            Include subfolders (recursive)
                        </label>
                    </div>

                    <div class="batch-section">
                        <button id="batch-show-options" type="button">Advanced Export Options...</button>
                    </div>

                    <div id="batch-progress" class="batch-progress hidden">
                        <div class="progress-bar">
                            <div class="progress-fill" id="batch-progress-fill"></div>
                        </div>
                        <div class="progress-text">
                            <span id="batch-progress-text">Processing...</span>
                            <span id="batch-progress-count">0 / 0</span>
                        </div>
                    </div>
                </div>
                <div class="batch-dialog-footer">
                    <button id="batch-cancel">Cancel</button>
                    <button id="batch-start" class="primary" disabled>Start Conversion</button>
                </div>
            </div>
        </div>

        <div class="editor-container">
            <div class="tab-content active" id="tab-content-1" data-tab-id="1">
                <div id="editor-pane-1" class="pane">
                    <div class="editor-wrapper">
                        <div id="line-numbers-1" class="line-numbers hidden"></div>
                        <textarea id="editor-1" class="editor-textarea"></textarea>
                    </div>
                </div>
                <div id="preview-pane-1" class="pane">
                    <div id="preview-1" class="preview-content"></div>
                </div>
            </div>
        </div>
        
        <div class="status-bar">
            <span id="status-text">Ready</span>
            <span id="word-count">Words: 0 | Characters: 0</span>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>